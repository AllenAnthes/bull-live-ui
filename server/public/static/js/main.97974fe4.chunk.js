(this["webpackJsonpbull-live-ui-app"]=this["webpackJsonpbull-live-ui-app"]||[]).push([[0],{408:function(e,t,n){e.exports=n(537)},533:function(e,t){},537:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(16),c=n.n(i),o=n(10),l=n(17),s=n(274),u=n(82),d=n(65),m=n(568),f=n(564),p=n(331),h=n(222),b=n.n(h),E=n(269),g=n(56),O=n(398),v=n.n(O),w=n(399),j=n.n(w),C=n(539),y=n(571),S=n(351),D=n(570),R=n(545),k=n(400),T=n.n(k),x=n(2),P=n(388),B=n.n(P),N=n(110),q=n(573),L=n(560),U=n(397),_=n.n(U),A=n(395),Q=n.n(A),H=n(561),I=n(396),W=n.n(I),F=n(565),z=n(567),J=n(566),K=function(e){var t=e.data,n=e.title;return r.a.createElement(F.a,{elevation:0},r.a.createElement(z.a,{title:n}),r.a.createElement(J.a,null,r.a.createElement(W.a,{collapsed:3,displayDataTypes:!1,enableClipboard:!1,src:t,shouldCollapse:function(e){var t=e.src;return Array.isArray(t)&&t.length>5},name:null})))},M=function(e){var t,n=e.rowData;return r.a.createElement(H.a,{container:!0,spacing:2,justify:"space-evenly",style:{padding:"1rem"}},(null===(t=n.stacktrace)||void 0===t?void 0:t.length)>0&&r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(K,{data:n.stacktrace,title:"Stacktrace:"})),r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(K,{data:n.data,title:"Data:"})),r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(K,{data:n.opts,title:"Options:"})))},G=n(272),V=n(574),X=n(572),Y=n(363),Z=function(e){return function(t){var n=function(e){var t=e.fieldOrDate,n=e.data;return t instanceof Date?t:n[t]?new Date(n[t]):void 0}({fieldOrDate:e,data:t});if(n){var a=Object(G.default)(n,"HH:mm:ss"),i=Object(V.a)(n,{includeSeconds:!0,addSuffix:!0});return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{variant:"body2"},a),r.a.createElement(g.a,{variant:"caption"},"(",i,")"))}}},$=n(348),ee=n(569),te=n(558),ne=n(559),ae=n(557),re=function(e){var t=e.tab,n=e.onClose,a=e.tableRef,i=e.baseUrl;return r.a.createElement(ae.a,{open:!0,onClose:n},r.a.createElement(ee.a,null,"Delete Jobs"),r.a.createElement(te.a,null,"Are you sure you want to delete all ",t," jobs? This cannot be undone."),r.a.createElement(ne.a,null,r.a.createElement($.a,{autoFocus:!0,variant:"outlined",onClick:n},"Cancel"),r.a.createElement($.a,{onClick:function(){return fetch("".concat(i,"/jobs?type=").concat(t),{method:"DELETE"}).then(a.current.onQueryChange).then(n)},variant:"contained",color:"secondary"},"Confirm")))},ie=b()((function(e){return{progressBar:{backgroundColor:e.palette.success.main},progressBarError:{backgroundColor:e.palette.error.main},liveUpdateButton:{color:function(t){return t.isLiveUpdating?e.palette.success.main:e.palette.action.disabled}},title:{fontSize:14},container:{maxWidth:"100%",minWidth:"75%"}}})),ce=Q()(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SOCKET_IO_URI,{transports:["websocket","polling"]}),oe=function(e){var t=e.name,n=Object(a.useRef)(),i=Object(a.useRef)(!0),c=Object(u.c)("tab",u.b),o=Object(l.a)(c,2),s=o[0],d=o[1],m=Object(a.useState)({}),f=Object(l.a)(m,2),p=f[0],h=f[1],b=Object(a.useState)(null),E=Object(l.a)(b,2),O=E[0],v=E[1],w=Object(a.useState)(!0),j=Object(l.a)(w,2),C=j[0],y=j[1],S=Object(a.useState)(10),D=Object(l.a)(S,2),R=D[0],k=D[1],T=ie({isLiveUpdating:C}),x="".concat(window.location.origin).concat(window.location.pathname,"queues/").concat(t);Object(a.useEffect)((function(){return C?ce.emit("subQueue",{queueName:t},(function(e){h(e.counts)})):ce.emit("unsubQueue",{queueName:t}),function(){ce.emit("unsubQueue",{queueName:t})}}),[C,t]),Object(a.useEffect)((function(){!i.current&&n.current&&n.current.onQueryChange(),i.current=!1}),[t]),Object(a.useEffect)((function(){ce.removeAllListeners(),ce.on("progress",(function(e){n.current&&n.current.onQueryChange(),h(e.counts)}))}),[]);var P=function(e){var t=e.classes,n=e.tab;return[{title:"Id",field:"id",width:75,render:function(e){return e.id.length>12?"#".concat(e.id.slice(0,12),"..."):"#".concat(e.id)}},{title:"Progress",field:"progress",removable:!0,width:50,render:function(e){return r.a.createElement(Y.a,{thickness:10,color:"primary",classes:{barColorPrimary:e.failedReason?t.progressBarError:t.progressBar},value:e.progress,variant:"determinate"})}},{title:"Created",field:"timestamp",render:Z("timestamp"),width:200},{title:"Next Run",hidden:"delayed"!==n,render:function(e){var t=new Date(e.timestamp+e.delay);return Z(t)(e)}},{title:"Job Started",field:"processedOn",render:Z("processedOn"),width:200,hidden:["waiting","delayed"].includes(n)},{title:"Waited",field:"processedOn",width:200,render:function(e){if(e.processedOn)return Object(X.a)(new Date(e.processedOn),new Date(e.timestamp),{unit:"second"})},hidden:["waiting","delayed"].includes(n)},{title:"Finished",field:"finishedOn",width:200,render:Z("finishedOn"),hidden:!["latest","completed","failed"].includes(n)},{title:"Run Time",field:"finishedOn",width:100,render:function(e){if(e.finishedOn)return Object(X.a)(new Date(e.finishedOn),new Date(e.timestamp),{unit:"second"})},hidden:!["latest","completed","failed"].includes(n)},{title:"Execution Time",field:"finishedOn",width:100,render:function(e){if(e.finishedOn)return Object(X.a)(new Date(e.finishedOn),new Date(e.processedOn),{unit:"second"})},hidden:!["latest","completed","failed"].includes(n)},{title:"Failed Reason",field:"failedReason",hidden:"failed"!==n}]}({classes:T,tab:s}),U=[{isFreeAction:!0,tooltip:"".concat(C?"Disable":"Enable"," Live Updates"),icon:function(){return r.a.createElement(_.a,{className:T.liveUpdateButton})},onClick:function(){return y((function(e){return!e}))}},{isFreeAction:!0,tooltip:"Delete all ".concat(s," jobs"),icon:"delete",iconProps:{color:"error"},onClick:function(){return v(s)},hidden:"latest"===s},{icon:"delete",tooltip:"Remove job",iconProps:{color:"error"},onClick:function(e,t){return fetch("".concat(x,"/jobs/").concat(t.id),{method:"DELETE"}).then(n.current.onQueryChange)}},function(e){return{icon:"replay",disabled:!e.failedReason,toolTip:"Retry",onClick:function(e,t){var a=t.id;return fetch("".concat(x,"/jobs/").concat(a,"/retry"),{method:"POST"}).then(n.current.onQueryChange)},hidden:!e.failedReason}}],A={initialPage:0,loadingType:"linear",pageSize:R,pageSizeOptions:[5,10,20,50,100],actionsColumnIndex:-1,columnsButton:!0,search:!1,sorting:!1};return r.a.createElement(N.a,{square:!0,className:T.container},r.a.createElement(q.a,{value:s||"latest",onChange:function(e,t){d(t),n.current&&n.current.onQueryChange()}},["latest","active","waiting","completed","failed","delayed","paused"].map((function(e,t){return r.a.createElement(L.a,{key:e,label:r.a.createElement(g.a,null,"".concat(e,"  "),p[e]?r.a.createElement(g.a,{variant:"caption"},"(",p[e],")"):null),value:e,"aria-controls":"tabpanel-".concat(t),id:"tab-".concat(t)})}))),r.a.createElement(B.a,{onChangeRowsPerPage:function(e){return k(e)},tableRef:n,actions:U,options:A,data:function(e){var t=new URL("".concat(x,"/jobs"));return Object.entries(e).filter((function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]);return Boolean(n)})).forEach((function(e){var n=Object(l.a)(e,2),a=n[0],r=n[1];return t.searchParams.append(a,r)})),"latest"!==s&&t.searchParams.append("type",s),fetch(t.toString()).then((function(e){return e.json()})).then((function(t){var n=null!==t&&void 0!==t?t:{},a=n.jobs,r=n.counts,i=null!==a&&void 0!==a?a:{},c=i.totalCount,o=i.page,l=i.data;h(r);var s=Math.floor(a.totalCount/e.pageSize);return{totalCount:c,page:Math.min(s,o),data:l}}))},title:t,columns:P,detailPanel:function(e){return r.a.createElement(M,{rowData:e})}}),O&&r.a.createElement(re,{onClose:function(){return v(null)},tab:O,tableRef:n,baseUrl:x}))},le=b()((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),drawerHeaderTitle:{textAlign:"center",width:"100%"},content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}}));var se=function(){var e=le(),t=Object(u.d)({queue:u.b,tab:Object(u.e)(u.b,"latest")}),n=Object(l.a)(t,2),i=n[0].queue,c=n[1],s=r.a.useState(!0),h=Object(l.a)(s,2),b=h[0],O=h[1],w=Object(a.useState)([]),k=Object(l.a)(w,2),P=k[0],B=k[1];return Object(a.useEffect)((function(){fetch("".concat(window.location.origin).concat(window.location.pathname,"queues/")).then((function(e){return e.json()})).then((function(e){var t;B(e.queues||[]),(null===(t=e.queues)||void 0===t?void 0:t.length)&&c({queue:e.queues[0]})}))}),[]),r.a.createElement("div",{className:e.root},r.a.createElement(m.a,null),r.a.createElement(f.a,{position:"fixed",className:Object(x.a)(e.appBar,Object(o.a)({},e.appBarShift,b))},r.a.createElement(p.a,null,r.a.createElement(E.a,{color:"inherit","aria-label":"open drawer",onClick:function(){return O(!0)},edge:"start",className:Object(x.a)(e.menuButton,b&&e.hide)},r.a.createElement(v.a,null)),r.a.createElement(g.a,{variant:"h5",noWrap:!0},"Bull Live UI"))),r.a.createElement(d.a,{className:e.drawer,variant:"persistent",anchor:"left",open:b,classes:{paper:e.drawerPaper}},r.a.createElement("div",{className:e.drawerHeader},r.a.createElement(g.a,{className:e.drawerHeaderTitle,variant:"h6"},"Queues"),r.a.createElement(E.a,{onClick:function(){return O(!1)}},r.a.createElement(j.a,null))),r.a.createElement(D.a,null),r.a.createElement(R.a,null,P.map((function(e){return r.a.createElement(C.a,{button:!0,key:e,onClick:function(){return c({queue:e})}},r.a.createElement(y.a,null,r.a.createElement(T.a,null)),r.a.createElement(S.a,{primary:e}))})))),r.a.createElement("main",{className:Object(x.a)(e.content,Object(o.a)({},e.contentShift,b))},r.a.createElement("div",{className:e.drawerHeader}),i&&r.a.createElement(oe,{name:i})))},ue=n(401),de=n(28);c.a.render(r.a.createElement(ue.a,null,r.a.createElement(u.a,{ReactRouterRoute:de.a},r.a.createElement(se,null))),document.getElementById("root"))}},[[408,1,2]]]);
//# sourceMappingURL=main.97974fe4.chunk.js.map